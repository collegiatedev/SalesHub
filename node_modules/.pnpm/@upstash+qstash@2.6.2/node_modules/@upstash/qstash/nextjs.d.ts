import { NextApiHandler } from 'next';
import { NextRequest, NextFetchEvent, NextResponse } from 'next/server';

type VerifySignatureConfig = {
    currentSigningKey?: string;
    nextSigningKey?: string;
    /**
     * The url of this api route, including the protocol.
     *
     * If you omit this, the url will be automatically determined by checking the `VERCEL_URL` env variable and assuming `https`
     */
    url?: string;
    /**
     * Number of seconds to tolerate when checking `nbf` and `exp` claims, to deal with small clock differences among different servers
     *
     * @default 0
     */
    clockTolerance?: number;
};
declare function verifySignature(handler: NextApiHandler, config?: VerifySignatureConfig): NextApiHandler;
declare function verifySignatureEdge(handler: (request: NextRequest, nfe?: NextFetchEvent) => NextResponse | Promise<NextResponse>, config?: VerifySignatureConfig): (request: NextRequest, nfe: NextFetchEvent) => Promise<NextResponse<unknown>>;
type VerifySignatureAppRouterResponse = NextResponse | Promise<NextResponse> | Response | Promise<Response>;
declare function verifySignatureAppRouter(handler: ((request: Request) => VerifySignatureAppRouterResponse) | ((request: NextRequest) => VerifySignatureAppRouterResponse), config?: VerifySignatureConfig): (request: NextRequest | Request) => Promise<Response>;

export { type VerifySignatureConfig, verifySignature, verifySignatureAppRouter, verifySignatureEdge };
